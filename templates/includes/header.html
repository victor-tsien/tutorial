<!-- templates/includes/header.html -->
<header class="header">
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <!-- 品牌Logo和名称 -->
            <a class="navbar-brand d-flex align-items-center" href="#">
                <div class="brand-logo me-2">
                    <i class="bi bi-journal-text text-primary fs-4"></i>
                </div>
                <span class="fw-bold fs-5">CRM</span>
            </a>

            <!-- 移动端汉堡菜单按钮 -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- 导航菜单 -->
            <div class="collapse navbar-collapse" id="navbarMain">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <!-- 主页链接 -->
                    <li class="nav-item">
                        <a class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}" 
                           href="#">
                            <i class="bi bi-house-door me-1"></i>首页
                        </a>
                    </li>
                    
                    <!-- 日志模块 -->
                    <li class="nav-item">
                        <a class="nav-link {% if 'wlog' in request.resolver_match.app_names %}active{% endif %}" 
                           href="{% url 'wlog:titles' %}">
                            <i class="bi bi-journal me-1"></i>工作日志
                        </a>
                    </li>
                    
                    <!-- 其他模块示例（可根据实际需求添加） -->
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="bi bi-people me-1"></i>客户管理
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="bi bi-bar-chart me-1"></i>数据统计
                        </a>
                    </li>
                </ul>

                <!-- 右侧功能区域 -->
                <div class="d-flex align-items-center">

                    <!-- 用户信息 -->
                    <div class="dropdown">
                        <a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" 
                           id="userDropdown" data-bs-toggle="dropdown">
                            <div class="user-avatar me-2">
                                <div class="avatar-circle bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" 
                                     style="width: 36px; height: 36px;">
                                    {% if user.is_authenticated %}
                                        {{ user.username|first|upper }}
                                    {% else %}
                                        <i class="bi bi-person"></i>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="user-info d-none d-md-block">
                                <small class="text-muted d-block">欢迎回来</small>
                                <span class="fw-semibold">
                                    {% if user.is_authenticated %}
                                        {{ user.username }}
                                    {% else %}
                                        访客
                                    {% endif %}
                                </span>
                            </div>
                        </a>
                        
                        <!-- 用户下拉菜单 -->
                        <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="userDropdown">
                            {% if user.is_authenticated %}
                                <li>
                                    <a class="dropdown-item" href="#">
                                        <i class="bi bi-person-circle me-2"></i>个人资料
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#">
                                        <i class="bi bi-gear me-2"></i>系统设置
                                    </a>
                                </li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <a class="dropdown-item text-danger" href="#">
                                        <i class="bi bi-box-arrow-right me-2"></i>退出登录
                                    </a>
                                </li>
                            {% else %}
                                <li>
                                    <a class="dropdown-item" href="{% url 'login' %}">
                                        <i class="bi bi-box-arrow-in-right me-2"></i>登录
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="{% url 'register' %}">
                                        <i class="bi bi-person-plus me-2"></i>注册
                                    </a>
                                </li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    
<!-- 页面消息提示（成功/错误信息） -->
{% if messages %}
<div class="container mt-3">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
</div>
{% endif %}